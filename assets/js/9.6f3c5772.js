(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{444:function(t,s,a){t.exports=a.p+"assets/img/viteServer.30da50e4.png"},478:function(t,s,a){"use strict";a.r(s);var n=a(39),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"相对于webpack优势"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#相对于webpack优势"}},[t._v("#")]),t._v(" 相对于webpack优势")]),t._v(" "),n("p",[t._v("项目越大，所要处理的js代码就越多，造成的结果"),n("code",[t._v("构建工具")]),t._v("需要很长时间才能启动"),n("code",[t._v("开发服务器")]),t._v("把项目跑起来"),n("br"),t._v("\n即使使用了热更新，文件修改后也要几秒钟才能在浏览器中反映出来，迟钝会影响开发者的开发效率")]),t._v(" "),n("p",[t._v("webpack能改吗？")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// webpack支持多种模块化，开始必须要统一模块化代码,")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所以意味着他需要将所有的依赖全部读一遍")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lodash "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lodash"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// commonjs 规范")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// es6 module")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// webpack的一个转换结果")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lodash "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("webpack_require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lodash"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Vue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("webpack_require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[n("code",[t._v("vite")]),t._v("是基于"),n("code",[t._v("es modules")]),t._v("的, 侧重点不一样, "),n("code",[t._v("webpack")]),t._v("更多的关注兼容性, 而"),n("code",[t._v("vite")]),t._v("关注浏览器端的开发体验"),n("br"),t._v(" "),n("code",[t._v("vite")]),t._v("的上手难度更低，直接启动开发服务器根据"),n("code",[t._v("entry")]),t._v("按需加载"),n("br"),t._v(" "),n("img",{attrs:{src:a(444),alt:"vite es moudle server"}})]),t._v(" "),n("h2",{attrs:{id:"create-vite脚手架和vite"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#create-vite脚手架和vite"}},[t._v("#")]),t._v(" create vite脚手架和vite")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("yarn create vite")]),t._v(" "),n("ul",[n("li",[t._v("帮我们全局安装一个东西: create-vite (vite的脚手架)")]),t._v(" "),n("li",[t._v("直接运行这个create-vite bin目录的下的一个执行配置")])])])]),t._v(" "),n("p",[n("code",[t._v("create vite")]),t._v("内置了"),n("code",[t._v("vite")]),n("br"),t._v(" "),n("code",[t._v("vue-cli")]),t._v("内置"),n("code",[t._v("webpack")]),n("br"),t._v("\nvite、create-vite ---\x3e vue团队")]),t._v(" "),n("p",[t._v("使用脚手架创建"),n("code",[t._v("vue-cli")]),t._v("/"),n("code",[t._v("create vite")]),t._v("(相当于给你一套预设)：less, babel下载并配置好了"),n("br"),t._v("\n自己搭建：自家下载插件处理")]),t._v(" "),n("h2",{attrs:{id:"初体验-开箱即用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初体验-开箱即用"}},[t._v("#")]),t._v(" 初体验（开箱即用）")]),t._v(" "),n("p",[t._v("在默认情况下，"),n("code",[t._v("es module")]),t._v("导资源要么是相对路径，要么是绝对路径，否则浏览器不知道怎么去找")]),t._v(" "),n("ul",[n("li",[t._v("那为什么es官方不默认搜寻node_modules呢？\n"),n("ul",[n("li",[t._v("如果浏览器可以做，可以找到下面"),n("code",[t._v("lodash")]),t._v("，那"),n("code",[t._v("lodash")]),t._v("下是也就会有更多的"),n("code",[t._v("import")])]),t._v(" "),n("li",[t._v("浏览器中模块是通过"),n("code",[t._v("http")]),t._v("加载的，太多的话消耗浏览器的性能")]),t._v(" "),n("li",[n("code",[t._v("commonjs")]),t._v("是运行在服务端，不一样，它找node_modules不是通过网络请求")])])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// index.html")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script src"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./man.js"')]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"module"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// man.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./count.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 安装")]),t._v("\nyarn init "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("y\nyarn add lodash\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// count.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" _ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lodash'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在默认情况下，es module导资源要么是相对路径")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 要么是绝对路径，否则浏览器不知道怎么去找")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" count "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 安装")]),t._v("\nyarn add vite "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("D")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 安装vite会处理找到，路径补全")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// import _ from "/node_modules/.vite/lodash";')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// import __vite__cjsImport0_lodash from ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "/node_modules/.vite/deps/lodash.js?v=55bcfa4a";')]),t._v("\n")])])]),n("h2",{attrs:{id:"依赖预构建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#依赖预构建"}},[t._v("#")]),t._v(" 依赖预构建")]),t._v(" "),n("p",[t._v("vite找到对应的依赖后，然后调用"),n("code",[t._v("esbuild")]),t._v("将其他规范的代码转换成"),n("code",[t._v("es module")]),t._v("规范，\n然后放到当前目录下的"),n("code",[t._v("node_modules/.vite/deps")]),t._v("对"),n("code",[t._v("esmodule")]),t._v("规范的各个模块进行统一集成")]),t._v(" "),n("ul",[n("li",[t._v("开发\n"),n("ul",[n("li",[t._v("yarn dev：开发环境每次重新构建vite去搜索补全路径，就是上面的"),n("code",[t._v("依赖预构建")])])])]),t._v(" "),n("li",[t._v("生产\n"),n("ul",[n("li",[t._v("生产环境"),n("code",[t._v("vite")]),t._v("交给一个叫做"),n("code",[t._v("rollup")]),t._v("的库去完成打包，会兼容更多的场景，例如有的三方库（axios）是以"),n("code",[t._v("commonjs")]),t._v("规范导出，"),n("code",[t._v("module.exports")]),t._v("，")])])])]),t._v(" "),n("ul",[n("li",[t._v("vite解决的问题\n"),n("ul",[n("li",[t._v("第三方包不同的导出格式")]),t._v(" "),n("li",[t._v("路径的处理"),n("code",[t._v("node_modules/.vite/deps")])]),t._v(" "),n("li",[t._v("*** 网络多包传输的性能问题-上面举例"),n("code",[t._v("loadsh")]),t._v("下会有更多的导入问题，有了依赖预构建vite会将他们进行集成最后只生成一个或者几个模块")])])])]),t._v(" "),n("h2",{attrs:{id:"vite配置文件智能提示和环境处理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite配置文件智能提示和环境处理"}},[t._v("#")]),t._v(" vite配置文件智能提示和环境处理")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://cn.vitejs.dev/config/#config-intellisense",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考官网vite配置智能提示 - https://cn.vitejs.dev/config/#config-intellisense"),n("OutboundLink")],1)]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("defineConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vite'")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第三方库")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineConfig")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("ul",[n("li",[t._v("区分环境去区分配置文件")]),t._v(" "),n("li",[n("code",[t._v("vite.config.js")]),t._v(" "),n("ul",[n("li",[t._v("vite.base.config.js")]),t._v(" "),n("li",[t._v("vite.prod.config.js")]),t._v(" "),n("li",[t._v("vite.dev.config.js")])])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 正常 vite.config.js vite默认读取的配置文件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("optimizeDeps")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 依赖不进行依赖预构建")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// exclude: ['lodash-es']")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("defineConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vite'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" viteBaseConfig "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./vite.base.config"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" viteProdConfig "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./vite.prod.config"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" viteDevConfig "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./vite.dev.config"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 策略模式")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" envResolver "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"build"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("assign")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" viteBaseConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" viteDevConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"serve"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'开发环境'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("assign")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" viteBaseConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" viteProdConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineConfig")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" envResolver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("h2",{attrs:{id:"vite环境变量"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite环境变量"}},[t._v("#")]),t._v(" vite环境变量")]),t._v(" "),n("p",[n("code",[t._v("vite")]),t._v("内置了"),n("code",[t._v("dotenv")]),t._v("这个第三方库，自动读取"),n("code",[t._v(".env")]),t._v("文件解析对应环境变量，\n然后将其注入到process对象下(但是vite考虑到和其他配置的一些冲突问题, 他不会直接注入到process对象下)")]),t._v(" "),n("p",[t._v("涉及到"),n("code",[t._v("vite.config.js")]),t._v("中的一些配置，"),n("code",[t._v("envDir")]),t._v(": 用来配置开发/生产环境变量的文件地址"),n("br"),t._v("\n可以在加载配置文件前，调用"),n("code",[t._v("vite")]),t._v("的"),n("code",[t._v("loadEnv方法")]),t._v("来手动确认"),n("code",[t._v("env")]),t._v("文件，这样就可以将.env当作所有环境下的共有变量")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// .env文件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("APP_KEY")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("110")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vite.config.js文件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineConfig")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log(process.env);  // 打印中没有APP_KEY")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'process.cwd() ---\x3e '")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cwd")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// process.cwd()方法返回当前node进程的工作目录")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第二个参数：当前env所在目录")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" env "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadEnv")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cwd")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第三个参数不传默认是.env")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log(env);  // 打印中就有APP_KEY了")]),t._v("\n\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'command ---\x3e '")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" envResolver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("ul",[n("li",[t._v("mode参数"),n("br"),t._v("\n是根据命令来的"),n("code",[t._v("yarn dev")]),t._v("相当于默认"),n("code",[t._v("yarn dev --mode development")]),t._v("，mode就是development"),n("br"),t._v("\n也可以手动"),n("code",[t._v("yarn dev --mode develop")]),t._v("，mode就是develop")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" env "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadEnv")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cwd")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用loadEnv, 会做如下几件事")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 找到.env文件解析其中的环境变量放进一个对象")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将传进来的mode这个变量的值进行拼接: .env.development，根据拼接名称去取对应的配置文件并环境变量, 并放进一个对象")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 最终得到的对象 const lastEnvConfig = { ...baseEnvConfig, ...modeEnvConfig }")]),t._v("\n")])])]),n("ul",[n("li",[t._v("客户端的使用"),n("br"),t._v("\nvite会将环境变量注入到"),n("code",[t._v("import.meta.env")]),t._v("里"),n("br"),t._v("\n注意vite做了一个拦截，避免将隐私性的变量直接注入进去"),n("br"),t._v("\n处理是在变量前加"),n("code",[t._v("VITE_")]),t._v("，"),n("code",[t._v("VITE_APP_KEY = 120")]),n("br"),t._v("\n可以通过配置-设置环境变量前缀"),n("code",[t._v("envPrefix: 'ENV_'")]),t._v("默认是"),n("code",[t._v("VITE_")])])]),t._v(" "),n("h2",{attrs:{id:"vite解析识别vue文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite解析识别vue文件"}},[t._v("#")]),t._v(" vite解析识别vue文件")]),t._v(" "),n("p",[n("code",[t._v("yarn create vite my-vue-app --template vue")]),t._v("通过脚手架创建项目"),n("br"),t._v(" "),n("code",[t._v("2、my-vue-app项目")]),n("br"),t._v("\n运行后在网络中看App.vue响应是js代码，它是如何解析的呢？初步了解开发服务器原理node"),n("br"),t._v("\n新建"),n("code",[t._v("3、vite-dev-server")]),t._v("中"),n("code",[t._v("yarn add koa")]),t._v("：node端的框架"),n("br"),t._v("\n通过"),n("code",[t._v("koa")]),t._v("实例返回请求地址案例，访问的App.vue文件最终是解析成js代码")]),t._v(" "),n("h2",{attrs:{id:"vite中css相关"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite中css相关"}},[t._v("#")]),t._v(" vite中css相关")]),t._v(" "),n("h3",{attrs:{id:"处理css大概原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#处理css大概原理"}},[t._v("#")]),t._v(" 处理css大概原理")]),t._v(" "),n("p",[t._v("vite本身支持对css的处理，初体验项目里")]),t._v(" "),n("ul",[n("li",[t._v("vite在读取到main.js中引用到了Index.css")])]),t._v(" "),n("ol",[n("li",[t._v("直接去使用fs模块去读取index.css中文件内容")]),t._v(" "),n("li",[t._v("直接创建一个style标签, 将index.css中文件内容直接copy进style标签里")]),t._v(" "),n("li",[t._v("将style标签插入到index.html的"),n("code",[t._v("head")]),t._v("中")]),t._v(" "),n("li",[t._v("将该css文件中的内容直接替换为js脚本(方便热更新或者css模块化), 同时设置Content-Type为js 从而让浏览器以JS脚本的形式来执行该css后缀的文件")])]),t._v(" "),n("ul",[n("li",[t._v("模块化场景：协同开发可能起一样的类名"),n("br"),t._v("\nmian.js中引入componentA.js和componentB.js，两套css创建同样类名会出现覆盖")])]),t._v(" "),n("ol",[n("li",[t._v("module.css (module是一种约定, 表示需要开启css模块化)")]),t._v(" "),n("li",[t._v("他会将你的所有类名进行一定规则的替换（将footer 替换成 _footer_i22st_1）")]),t._v(" "),n("li",[t._v('同时创建一个映射对象{ footer: "_footer_i22st_1" }')]),t._v(" "),n("li",[t._v("将替换过后的内容塞进style标签里然后放入到"),n("code",[t._v("head")]),t._v("标签中 (能够读到index.html的文件内容)")]),t._v(" "),n("li",[t._v("将componentA.module.css内容进行全部抹除, 替换成JS脚本（看network）")]),t._v(" "),n("li",[t._v("将创建的映射对象在脚本中进行默认导出")])]),t._v(" "),n("h3",{attrs:{id:"支持less-模块化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#支持less-模块化"}},[t._v("#")]),t._v(" 支持less（模块化）")]),t._v(" "),n("p",[t._v("安装"),n("code",[t._v("yarn add less")]),t._v("，main.js中导入less文件"),n("code",[t._v("index.module.less")])]),t._v(" "),n("h3",{attrs:{id:"vite中配置css"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite中配置css"}},[t._v("#")]),t._v(" vite中配置CSS")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://cn.vitejs.dev/config/shared-options.html#css-modules",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考地址https://cn.vitejs.dev/config/shared-options.html#css-modules"),n("OutboundLink")],1),n("br"),t._v("\n在配置文件中的配置"),n("code",[t._v("vite.base.config")]),t._v("，"),n("code",[t._v("css: { modules: {} }")])]),t._v(" "),n("ul",[n("li",[t._v("localsConvention：css生成类名key的展示形式")]),t._v(" "),n("li",[t._v("scopeBehaviour：")]),t._v(" "),n("li",[t._v("generateScopedName：css生成类名value的展示形式")]),t._v(" "),n("li",[t._v("hashPrefix")]),t._v(" "),n("li",[t._v("globalModulePaths：不参与到css模块化的路径")])]),t._v(" "),n("h3",{attrs:{id:"vite中配置预处理器选项-less-preprocessoroptions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite中配置预处理器选项-less-preprocessoroptions"}},[t._v("#")]),t._v(" vite中配置预处理器选项（less） preprocessorOptions")]),t._v(" "),n("p",[n("a",{attrs:{href:"http://lesscss.cn/usage/#less-options--math",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考地址-http://lesscss.cn/usage/#less-options--math"),n("OutboundLink")],1),n("br"),t._v("\n在配置文件中的配置"),n("code",[t._v("vite.base.config")]),t._v("，"),n("code",[t._v("css: { preprocessorOptions: {} }")])]),t._v(" "),n("ul",[n("li",[t._v("math：数学模式设置"),n("br"),t._v("\n安装了less就可以去编译less文件，就像node直接运行文件一样，"),n("code",[t._v("npx lessc .\\index.module.less")])]),t._v(" "),n("li",[t._v("globalVars：全局变量定义，不用import形式导文件"),n("code",[t._v("global.less")])])]),t._v(" "),n("h3",{attrs:{id:"devsourcemap显示源文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#devsourcemap显示源文件"}},[t._v("#")]),t._v(" devSourcemap显示源文件")]),t._v(" "),n("p",[t._v("在配置文件中的配置"),n("code",[t._v("vite.base.config")]),t._v("，"),n("code",[t._v("css: { devSourcemap: true }")]),n("br"),t._v("\n网页header中会显示源文件，假设程序出错，就会有索引文件")]),t._v(" "),n("h2",{attrs:{id:"vite中postcss"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite中postcss"}},[t._v("#")]),t._v(" vite中postcss")]),t._v(" "),n("p",[t._v("vite本身就支持postcss，配置插件去做不同的事情，设计之初想承担的维护成本是要高于less的")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("例如考虑浏览器兼容，它可以做："),n("br"),t._v("\n语法降级（css变量） --- 前缀补全（--webkit） --- less编译（postcss对预处理器的插件已经停止维护，需要less自己编译，把编译结果给postcss）")])]),t._v(" "),n("li",[n("p",[t._v("使用postcss（test-postcss项目）"),n("br"),t._v(" "),n("code",[t._v("yarn add postcss-cli postcss -D")]),t._v("，"),n("code",[t._v("postcss-cli")]),t._v("使用脚手架命令，"),n("code",[t._v("postcss")]),t._v("编译操作"),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/postcss/postcss-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("postcss-cli命令参考地址-https://github.com/postcss/postcss-cli"),n("OutboundLink")],1),n("br"),t._v(" "),n("code",[t._v("npx postcss index.css -o result.css")])])])]),t._v(" "),n("p",[n("code",[t._v("postcss.config.js配置文件")]),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/postcss/postcss/blob/main/docs/plugins.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("postcss插件参考地址-https://github.com/postcss/postcss/blob/main/docs/plugins.md"),n("OutboundLink")],1),n("br"),t._v(" "),n("code",[t._v("yarn add postcss-preset-env -D")]),t._v("安装预设环境，它包含了很多必要插件，例如就可以做语法降级，自动补全等")]),t._v(" "),n("ul",[n("li",[t._v("vite中postcss的设置（test-vite项目）\n"),n("ul",[n("li",[t._v("两种方式都可")]),t._v(" "),n("li",[t._v("vite配置文件中"),n("code",[t._v("css: { postcss: { plugins: [ postcssPresetEnv(/* pluginOptions */)")])]),t._v(" "),n("li",[t._v("新建"),n("code",[t._v("postcss.config.js")]),t._v("配置文件")])])])]),t._v(" "),n("h2",{attrs:{id:"path-resolve-题外篇"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#path-resolve-题外篇"}},[t._v("#")]),t._v(" path.resolve()题外篇")]),t._v(" "),n("p",[t._v("node端去读取文件或者操作文件的时候, 如果发现你用的是相对路径, 则可使用"),n("code",[t._v("process.cwd()")]),t._v("来进行对应的拼接"),n("br"),t._v(" "),n("code",[t._v("process.cwd")]),t._v("：获取当前的node执行目录"),n("br"),t._v("\ncommonjs规范注入的变量"),n("code",[t._v("__dirname")]),t._v("：返回的是当前文件所在的目录")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// path本质上就是一个字符串处理模块, 它里面有非常多的路径字符串处理方法")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const result = fs.readFileSync('./variable.css');")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" result "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./variable.css"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cwd")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// node执行目录")]),t._v("\n    __dirname "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\n'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当前文件所在目录")]),t._v("\n    path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./variable.css"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 拼接字符串，进行一个绝对路径的生成")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h2",{attrs:{id:"vite加载静态资源"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite加载静态资源"}},[t._v("#")]),t._v(" vite加载静态资源")]),t._v(" "),n("p",[t._v("vite对静态资源基本上是开箱即用的")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("svg")]),t._v("：不会失真，尺寸小"),n("br"),t._v("\n缺点：没法很好的去表示层次丰富的图片信息，一般用"),n("code",[t._v("svg")]),t._v("去做图标")])]),t._v(" "),n("h2",{attrs:{id:"alias-路径别名"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#alias-路径别名"}},[t._v("#")]),t._v(" alias 路径别名")]),t._v(" "),n("p",[t._v("vite配置文件中")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("alias")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"@"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"@assets"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/assets"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sylasPicUrl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@assets/sylas.png"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"alias原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#alias原理"}},[t._v("#")]),t._v(" alias原理")]),t._v(" "),n("p",[n("code",[t._v("3、vite-dev-server")]),t._v("项目中，node端将请求资源返回的页面使用"),n("code",[t._v("alias")]),t._v("的地方进行字符串替换")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" viteConfig "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./vite.config"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" aliasResolver "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./aliasResolver"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("endsWith")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('".js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" JSContent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("promises"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"."')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在服务端一般不会这么用")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 对使用alias的地方进行字符串替换")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lastResult "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("aliasResolver")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("viteConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resolve"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alias"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" JSContent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" lastResult"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/javascript"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"vite在生产环境对静态资源的处理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite在生产环境对静态资源的处理"}},[t._v("#")]),t._v(" vite在生产环境对静态资源的处理")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("打包后的静态资源为什么要有hash")]),t._v(" "),n("ul",[n("li",[t._v("刷新页面-看请求的名字是不是同一个，读取缓存")]),t._v(" "),n("li",[t._v("hash算法: 将一串字符串经过运算得到一个新的乱码字符串")])])]),t._v(" "),n("li",[n("p",[t._v("控制输出文件名"),n("code",[t._v('build: { rollupOptions: { output: { assetFileNames: "[hash].[name].[ext]" }}}')]),n("br"),t._v(" "),n("a",{attrs:{href:"https://rollupjs.org/javascript-api/#outputoptions-object",target:"_blank",rel:"noopener noreferrer"}},[t._v("rollup-output配置项参考地址"),n("OutboundLink")],1)])])]),t._v(" "),n("h2",{attrs:{id:"vite插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite插件"}},[t._v("#")]),t._v(" vite插件")]),t._v(" "),n("p",[t._v("就像在"),n("code",[t._v("postcss")]),t._v("中讲到，"),n("code",[t._v("less")]),t._v("和"),n("code",[t._v("postcss")]),t._v("对"),n("code",[t._v("css")]),t._v("做的不同处理"),n("br"),t._v("\nvite会在"),n("code",[t._v("生命周期")]),t._v("的不同阶段中去调用不同的插件以达到不同的目的（生命周期：vite从开始执行到执行结束的过程）"),n("br"),t._v("\n与webpack类似")]),t._v(" "),n("h3",{attrs:{id:"vite-aliases插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite-aliases插件"}},[t._v("#")]),t._v(" vite-aliases插件")]),t._v(" "),n("p",[t._v("自动生成别名，安装"),n("code",[t._v("yarn add vite-aliases -D")]),n("br"),t._v(" "),n("a",{attrs:{href:"https://cn.vitejs.dev/plugins/#community-plugins",target:"_blank",rel:"noopener noreferrer"}},[t._v("vite官网--\x3e插件--\x3e社区插件--\x3e搜vite-aliases"),n("OutboundLink")],1),n("br"),t._v("\n参考用法："),n("code",[t._v("yarn add vite-aliases -D")]),n("br"),t._v("\n可能会遇到node版本问题，可以使用"),n("code",[t._v("nvm")]),t._v("方便切换node版本，"),n("a",{attrs:{href:"https://blog.csdn.net/m0_65634497/article/details/127789013",target:"_blank",rel:"noopener noreferrer"}},[t._v("nvm使用参考"),n("OutboundLink")],1)]),t._v(" "),n("ul",[n("li",[t._v("使用：在vite配置文件"),n("code",[t._v("vite.base.config")]),t._v("手动设置resolve注释，导入"),n("code",[t._v("ViteAliases")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 会根据你的项目目录自动生成")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("find")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("replacement")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'${your_project_path}/src'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("find")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@assets'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("replacement")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'${your_project_path}/src/assets'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),n("h3",{attrs:{id:"手写vite-aliases插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#手写vite-aliases插件"}},[t._v("#")]),t._v(" 手写vite-aliases插件")]),t._v(" "),n("ul",[n("li",[t._v("参考："),n("br"),t._v(" "),n("a",{attrs:{href:"https://vitejs.dev/guide/api-plugin.html#vite-specific-hooks",target:"_blank",rel:"noopener noreferrer"}},[t._v("vite官网--\x3eGuide--\x3ePlugin API--\x3evite-specific-hooks--\x3econfig"),n("OutboundLink")],1),n("br"),t._v(" "),n("a",{attrs:{href:"https://cn.vitejs.dev/guide/api-plugin.html#vite-specific-hooks",target:"_blank",rel:"noopener noreferrer"}},[t._v("vite官网--\x3e指引--\x3e插件 API--\x3eVite 独有钩子--\x3econfig"),n("OutboundLink")],1)]),t._v(" "),n("li",[t._v("新建"),n("code",[t._v("'plugins/MyAliases'")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("keyName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在解析vite配置文件前调用config")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回值将会与vite配置文件合并，类似Object.assign")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("config")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" env")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" resolveAliasesObj "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTotalSrcDir")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("keyName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// alias: { '@assets': 'D:\\\\01、web\\\\learn-vite\\\\1、test-vite\\\\src\\\\assets' }")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("alias")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" resolveAliasesObj\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回指定地址下的文件夹和文件名数组")]),t._v("\nfs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("readdirSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../src"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 异步返回文件状态信息 isDirectory()")]),t._v("\nfs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("statSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" basePath "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"vite插件-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite插件-2"}},[t._v("#")]),t._v(" vite插件")]),t._v(" "),n("ul",[n("li",[t._v("vue团队--\x3evite：减少开发者成本，很多东西内置调用了，开箱即用例如一些loader")]),t._v(" "),n("li",[t._v("react：主动权交给开发者去维护"),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/vitejs/vite/blob/main/packages/vite/src/node/plugins/index.ts",target:"_blank",rel:"noopener noreferrer"}},[t._v("vite内部调用了很多插件参考"),n("OutboundLink")],1)])]),t._v(" "),n("h3",{attrs:{id:"vite-plugin-html插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite-plugin-html插件"}},[t._v("#")]),t._v(" vite-plugin-html插件")]),t._v(" "),n("ul",[n("li",[t._v("动态控制html内容---\x3eejs语法"),n("code",[t._v("<%= %>")])]),t._v(" "),n("li",[t._v("安装"),n("code",[t._v("yarn add vite-plugin-html -D")]),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/vbenjs/vite-plugin-html",target:"_blank",rel:"noopener noreferrer"}},[t._v("vite官网--\x3e插件--\x3e社区插件--\x3e搜vite-plugin-html"),n("OutboundLink")],1)])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("createHtmlPlugin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vite-plugin-html"')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineConfig")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createHtmlPlugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("inject")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("title")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"主页"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"手写vite-plugin-html插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#手写vite-plugin-html插件"}},[t._v("#")]),t._v(" 手写vite-plugin-html插件")]),t._v(" "),n("ul",[n("li",[t._v("参考："),n("br"),t._v(" "),n("a",{attrs:{href:"https://vitejs.dev/guide/api-plugin.html#transformindexhtml",target:"_blank",rel:"noopener noreferrer"}},[t._v("vite官网--\x3ePlugin API--\x3eVite Special Hooks--\x3etransformIndexHtml"),n("OutboundLink")],1)]),t._v(" "),n("li",[t._v("新建"),n("code",[t._v("MyCreateHtmlPlugin.js")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 转换html的")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// transformIndexHtml(html, ctx) {")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     // 注意html中body中使用，会报错没打印证明还没有执行到此处，")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     // 可能会有别的插件在这之前调用，所以我们要把执行时机提前")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     console.log(html, 1122);")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// }")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("transformIndexHtml")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将我们插件的一个执行时机提前")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("enforce")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pre"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("transform")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ctx")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// html内容")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ctx当前请求的一个执行期上下文")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("<%= title %>")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("inject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"vite结合ts"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite结合ts"}},[t._v("#")]),t._v(" vite结合ts")]),t._v(" "),n("p",[t._v("本身对"),n("code",[t._v("TS")]),t._v("有良好的支持（类型检查、语法提示）"),n("br"),t._v(" "),n("code",[t._v("6、vite-typescript")]),t._v("项目，开箱即用，但存在现象是编辑器检测错误，控制台和浏览器还正常")]),t._v(" "),n("ul",[n("li",[t._v("企业中ts检查配置，ts错误输出控制台"),n("br"),t._v(" "),n("a",{attrs:{href:"https://vite-plugin-checker.netlify.app/introduction/getting-started.html#getting-started",target:"_blank",rel:"noopener noreferrer"}},[t._v("vite结合ts检测"),n("OutboundLink")],1)])]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// yarn add vite-plugin-checker -D")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// yarn add typescript -D")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// tsconfig.json  配置ts检查规则")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"compilerOptions"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"skipLibCheck"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 跳过node_modules")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"moduleResolution"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模块解析错略")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"module"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ESNext"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ul",[n("li",[t._v("构建打包时，并不执行任何类型检查"),n("br"),t._v(" "),n("a",{attrs:{href:"https://cn.vitejs.dev/guide/features.html#typescript",target:"_blank",rel:"noopener noreferrer"}},[t._v("构建前检查"),n("OutboundLink")],1)])]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tsc --noEmit && vite build"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),n("ul",[n("li",[t._v("声明提示文件，三斜线指令声明")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vite-env.d.ts文件，提示环境变量为例")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/// <reference types="vite/client" />')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ImportMetaEnv")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    readonly "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("VITE_PRO_URL")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"vite性能优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite性能优化"}},[t._v("#")]),t._v(" vite性能优化")]),t._v(" "),n("ul",[n("li",[t._v("开发时构建速度")]),t._v(" "),n("li",[t._v("页面性能")]),t._v(" "),n("li",[t._v("js")]),t._v(" "),n("li",[t._v("css")]),t._v(" "),n("li",[t._v("生产优化vite（rollup）/webpack：分包、压缩、treeshaking、图片资源压缩、CDN")])]),t._v(" "),n("h3",{attrs:{id:"vite分包策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite分包策略"}},[t._v("#")]),t._v(" vite分包策略")]),t._v(" "),n("p",[t._v("打包js中代码会压缩，关掉要在vite配置文件"),n("code",[t._v("build: { minify: false }")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 安装lodash然后mian.ts使用")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ts类型声明 yarn add @types/lodash ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关掉打包不压缩")]),t._v("\n")])])]),n("p",[t._v("内容只要有一点变动，打包后生成文件就会生成新的hash值，例如lodash不需要更新的文件会重新请求，所以要进行单独打包处理"),n("br"),t._v(" "),n("a",{attrs:{href:"https://rollupjs.org/configuration-options/#output-manualchunks",target:"_blank",rel:"noopener noreferrer"}},[t._v("vite官网--\x3e配置--\x3e构建选项--\x3e搜rollupOptions"),n("OutboundLink")],1),n("br"),t._v(" "),n("code",[t._v("6、vite-typescript")]),t._v("项目")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vite配置文件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("build")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("minify")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关掉打包不压缩")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("rollupOptions")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置rollup的一些构建策略")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("output")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 控制输出")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("manualChunks")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// includes报错，ts认为你当前环境不在es6以后，"lib": ["ES2017", "DOM"]')]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("includes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node_modules'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vendor'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),n("h3",{attrs:{id:"gzip压缩"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#gzip压缩"}},[t._v("#")]),t._v(" gzip压缩")]),t._v(" "),n("p",[t._v("有时候文件过大，需要将静态资源进行压缩减小体积"),n("br"),t._v("\n将"),n("code",[t._v("test-vite")]),t._v("打包有如下提示，"),n("code",[t._v("chunk")]),t._v("--\x3e块的概念")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Some chunks are larger than "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v(" kBs after minification"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Consider"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" Using dynamic "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" to code"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("split the application "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 动态导入")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" Use build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rollupOptions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("manualChunks to improve chunking"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" https"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("rollupjs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("configuration"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("options"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("#output"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("manualchunks "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 分包")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" Adjust chunk size limit "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" warning via build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("chunkSizeWarningLimit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\ndist"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("assets"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("9c5b83c4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js        "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("053.05")]),t._v(" kB │ gzip"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("526.98")]),t._v(" kB "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用gzip压缩")]),t._v("\n")])])]),n("p",[n("a",{attrs:{href:"https://www.npmjs.com/package/vite-plugin-compression",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用vite-plugin-compression：npm官网--\x3e搜vite-plugin-compression"),n("OutboundLink")],1),n("br"),t._v(" "),n("code",[t._v("yarn add vite-plugin-compression -D")])]),t._v(" "),n("ul",[n("li",[t._v("原理：服务端读取"),n("code",[t._v("index.js.gz")]),t._v("文件，已经压缩过了不用压缩，设置响应头"),n("code",[t._v("content-encoding--\x3egzip")]),t._v("(告诉浏览器是使用gzip压缩过的)"),n("br"),t._v("\n浏览器收到解压得到原本js文件")]),t._v(" "),n("li",[t._v("可能存在问题：存在解压时间，体积不大不要用，适得其反")])]),t._v(" "),n("h3",{attrs:{id:"动态引入import"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#动态引入import"}},[t._v("#")]),t._v(" 动态引入import()")]),t._v(" "),n("p",[t._v("动态引入es6的新特性--\x3e使代码分割，和三方库按需加载相类似")]),t._v(" "),n("ul",[n("li",[t._v("常用：路由"),n("code",[t._v("component: () => import('../views/Login/Login.vue')")]),t._v("，只加载文件不执行")]),t._v(" "),n("li",[t._v("webpack实现动态导入："),n("code",[t._v("Promise")]),t._v("里"),n("code",[t._v("webpack_require.e()")]),t._v("状态")])]),t._v(" "),n("h3",{attrs:{id:"vite的cdn加速"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite的cdn加速"}},[t._v("#")]),t._v(" vite的cdn加速")]),t._v(" "),n("ul",[n("li",[t._v("将三方依赖模块写成cdn形式注入，使代码体积更小"),n("br"),t._v("\n正常打包会将三方库进行压缩"),n("br"),t._v(" "),n("code",[t._v("7、vite-cdn")]),t._v("项目")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// main.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" _ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lodash'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" obj "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" _"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cloneDeep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[n("a",{attrs:{href:"https://www.npmjs.com/package/vite-plugin-cdn-import",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用vite-plugin-cdn-import：npm官网--\x3e搜vite-plugin-cdn-import"),n("OutboundLink")],1),n("br"),t._v(" "),n("a",{attrs:{href:"https://www.jsdelivr.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("cdn地址参考：jsdelivr官网--\x3e搜lodash"),n("OutboundLink")],1),n("br"),t._v("\n在vite配置文件中使用")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("viteCDNPlugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("modules")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lodash'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js'")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),n("p",[t._v("原理："),n("code",[t._v("rollupOptions--\x3eexternalGlobals")])]),t._v(" "),n("h2",{attrs:{id:"vite中跨域"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite中跨域"}},[t._v("#")]),t._v(" vite中跨域")]),t._v(" "),n("p",[n("RouterLink",{attrs:{to:"/ajax/#同源策略"}},[t._v("同源策略参考")]),n("br"),t._v(" "),n("RouterLink",{attrs:{to:"/interview/vue.html#项目中解决跨域"}},[t._v("参考：解决跨域 vite/webpack/nginx/CORS/JSONP")])],1)])}),[],!1,null,null,null);s.default=e.exports}}]);